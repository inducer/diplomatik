\input header

\def\sheetheader{
\begin{center}
  {\bf\large Teilnoten Techno-Mathematik Hauptdiplom}
\end{center}
\bigskip\bigskip

Name, Vorname: \makebox[7.0cm]{\dotfill\qh{\tt $h.escapeTeX($student.LastName),
 $h.escapeTeX($student.FirstName)}\qh\dotfill}\hspace{0.25cm}
 Matrikelnummer: \hfill{\tt $student.ID}\\\\
Studienf\"acher: {\tt $h.escapeTeX($degree.MinorSubject),
 Angewandte Informatik#if ($zusatz), $h.escapeTeX($zusatz.Exams)#end}
\bigskip\bigskip
}

#macro (printexam $exam)
  $h.formatDate($exam.Date) &
  $h.escapeTeX($exam.Examiner) &
  #if ($exam.CountedResult)##
    #if ($exam.NativeResult)##
      $h.escapeTeX($exam.NativeResult) (=$h.formatNumber("%.1f", $exam.CountedResult))##
    #else ##
      $h.formatNumber("%.1f", $exam.CountedResult)##
    #end
  #else ##
    #if ($exam.NativeResult)##
      $h.escapeTeX($exam.NativeResult)##
    #else##
      - ##
    #end##
  #end &
  #if ($exam.Credits)##
    #if ($exam.CreditsPrintable)##
      $h.escapeTeX($exam.CreditsPrintable) ##
    #else ##
      $h.formatNumber("%.0f", $exam.Credits) ##
    #end ##
  #else
    - ##
  #end &
  #if ($exam.Credits)##
    #if ($exam.CountedResult)##
      $h.formatNumber("%.1f", $h.multiply($exam.Credits, $exam.CountedResult))
    #else##
      - ##
    #end##
  #else
    - ##
  #end \\\\
#end

#macro (emptyspace)##
 & & & &\\\\
 & & & &\\\\
#end

\begin{document}
\sheetheader

Teilpr\"ufungen\hspace*{0.4cm} {\tt Angewandte Mathematik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
  \hspace*{0.4cm}Datum\hspace*{0.4cm}&
  \hspace*{1.5cm}Pr\"ufer\hspace*{1.5cm}&
  \hspace*{0.2cm}Note\hspace*{0.2cm}&
  \hspace*{0.2cm}SWS\hspace*{0.2cm}&
  Note$*$SWS\\\\ \hline
  #foreach ($exam in $h.filterBy($exams, "DegreeComponent", "angewandt"))##
    #printexam($exam)
  #end ##
  #emptyspace() ##
\hline
\end{tabular}
\end{center}

\hspace*{8cm}Gewichtetes Mittel
#if ($math_complete)##
  $h.formatNumber("%.1f", $angewandt.WeightedGradeSum)
  {\bf :} $h.formatNumber("%.1f", $angewandt.Credits)
  {\bf = }$h.formatNumber("%.1f", $angewandt.AvgGrade)
#else##
  \hspace{2cm}{\bf :}\hspace{1cm}{\bf = }\underline{\hspace{2cm}}
#end

Bewertung\hspace*{0.4cm} {\tt Angewandte Mathematik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
\hspace*{0.4cm}Note\hspace*{0.4cm}&
\hspace*{0.4cm}Datum\hspace*{0.4cm}&
\hspace*{3.0cm}Pr\"ufer\hspace*{3.0cm}\\\\ 
\hline
#if ($math_complete) ##
 & & \\\\
 $h.formatNumber("%.1f", $angewandt.AvgGrade) &
 $h.formatDate($angewandt.EndDate) & 
 $h.escapeTeX($angewandt.Examiners) \\\\
 & & \\\\
#else ##
 & & \\\\
 & & \\\\
 & & \\\\ 
#end ##
 \hline
\end{tabular}
\end{center}
\bigskip\bigskip\bigskip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Teilpr\"ufungen\hspace*{0.4cm} {\tt Reine Mathematik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
  \hspace*{0.4cm}Datum\hspace*{0.4cm}&
  \hspace*{1.5cm}Pr\"ufer\hspace*{1.5cm}&
  \hspace*{0.2cm}Note\hspace*{0.2cm}&
  \hspace*{0.2cm}SWS\hspace*{0.2cm}&
  Note$*$SWS\\\\ 
  \hline
  #foreach ($exam in $h.filterBy($exams, "DegreeComponent", "rein"))##
    #printexam($exam)
  #end ##
  #emptyspace() ##
  \hline
\end{tabular}
\end{center}

\hspace*{8cm}Gewichtetes Mittel
#if ($math_complete)##
  $h.formatNumber("%.1f", $rein.WeightedGradeSum)
  {\bf :} $h.formatNumber("%.1f", $rein.Credits)
  {\bf = }$h.formatNumber("%.1f", $rein.AvgGrade)
#else##
  \hspace{2cm}{\bf :}\hspace{1cm}{\bf = }\underline{\hspace{2cm}}
#end

Bewertung\hspace*{0.4cm} {\tt Reine Mathematik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
\hspace*{0.4cm}Note\hspace*{0.4cm}&
\hspace*{0.4cm}Datum\hspace*{0.4cm}&
\hspace*{3.0cm}Pr\"ufer\hspace*{3.0cm}\\\\
\hline
#if ($math_complete) ##
 & & \\\\
 $h.formatNumber("%.1f", $rein.AvgGrade) &
 $h.formatDate($rein.EndDate) & 
 $h.escapeTeX($rein.Examiners) \\\\
 & & \\\\
#else ##
 & & \\\\
 & & \\\\
 & & \\\\
#end ##
 \hline
\end{tabular}
\end{center}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\sheetheader

Teilpr\"ufungen\hspace*{0.4cm} {\tt $h.escapeTeX($degree.MinorSubject)}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
  \hspace*{0.4cm}Datum\hspace*{0.4cm}&
  \hspace*{1.5cm}Pr\"ufer\hspace*{1.5cm}&
  \hspace*{0.2cm}Note\hspace*{0.2cm}&
  \hspace*{0.2cm}SWS\hspace*{0.2cm}&
  Note$*$SWS\\\\
  \hline
  #foreach ($exam in $h.filterBy($exams, "DegreeComponent", "ing"))##
    #printexam($exam)
  #end ##
  #emptyspace()
\hline
\end{tabular}
\end{center}

\hspace*{8cm}Gewichtetes Mittel
#if ($ing.Credits >= 12)##
  $h.formatNumber("%.1f", $ing.WeightedGradeSum)
  {\bf :} $h.formatNumber("%.1f", $ing.Credits)
  {\bf = }$h.formatNumber("%.1f", $ing.AvgGrade)
#else##
  \hspace{2cm}{\bf :}\hspace{1cm}{\bf = }\underline{\hspace{2cm}}
#end

Bewertung\hspace*{0.4cm} {\tt $h.escapeTeX($degree.MinorSubject)}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
\hspace*{0.4cm}Note\hspace*{0.4cm}&
\hspace*{0.4cm}Datum\hspace*{0.4cm}&
\hspace*{3.0cm}Pr\"ufer\hspace*{3.0cm}\\\\
\hline
#if ($ing.Credits >= 12) ##
 & & \\\\
 $h.formatNumber("%.1f", $ing.AvgGrade) &
 $h.formatDate($ing.EndDate) & 
 $h.escapeTeX($ing.Examiners) \\\\
 & & \\\\
#else ##
 & & \\\\
 & & \\\\
 & & \\\\
#end ##
 \hline
\end{tabular}
\end{center}
\bigskip\bigskip\bigskip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Teilpr\"ufungen\hspace*{0.4cm} {\tt Angewandte Informatik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
  \hspace*{0.4cm}Datum\hspace*{0.4cm}&
  \hspace*{1.5cm}Pr\"ufer\hspace*{1.5cm}&
  \hspace*{0.2cm}Note\hspace*{0.2cm}&
  \hspace*{0.2cm}SWS\hspace*{0.2cm}&
  Note$*$SWS\\\\
  \hline
  #foreach ($exam in $h.filterBy($exams, "DegreeComponent", "inf"))##
    #printexam($exam)
  #end ##
  #emptyspace()
  \hline
\end{tabular}
\end{center}

\hspace*{8cm}Gewichtetes Mittel
#if ($inf.Credits >= 10)##
  $h.formatNumber("%.1f", $inf.WeightedGradeSum)
  {\bf :} $h.formatNumber("%.1f", $inf.Credits)
  {\bf = }$h.formatNumber("%.1f", $inf.AvgGrade)
#else##
  \hspace{2cm}{\bf :}\hspace{1cm}{\bf = }\underline{\hspace{2cm}}
#end

Bewertung\hspace*{0.4cm} {\tt Angewandte Informatik}
\medskip

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
\hspace*{0.4cm}Note\hspace*{0.4cm}&
\hspace*{0.4cm}Datum\hspace*{0.4cm}&
\hspace*{3.0cm}Pr\"ufer\hspace*{3.0cm}\\\\
\hline
#if ($inf.Credits >= 10) ##
 & & \\\\
 $h.formatNumber("%.1f", $inf.AvgGrade) &
 $h.formatDate($inf.EndDate) & 
 $h.escapeTeX($inf.Examiners) \\\\
 & & \\\\
#else ##
 & & \\\\
 & & \\\\
 & & \\\\
#end ##
\hline
\end{tabular}
\end{center}


\end{document}
